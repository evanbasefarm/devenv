{

	"variables": {
		"currentuser": "{{env `USER`}}"
	},

	"builders": [{
		"type": "docker",
		"image": "ubuntu",
		"commit": true,
		"pull": true,
		"volumes": {
			"/home/evan/code": "/tmp/code:ro"
		}
	}],

	"provisioners": [{
		"type": "shell",
		"inline": [
			"apt-get -y update",
			"apt-get -y install curl nano unzip wget openssl",
			"curl -O https://bootstrap.pypa.io/get-pip.py",
			"python get-pip.py --user",
			"export PATH=~/.local/bin:$PATH",
			"pip install awscli --upgrade --user",
			"wget https://releases.hashicorp.com/terraform/0.11.8/terraform_0.11.8_linux_amd64.zip",
			"unzip terraform_0.11.8_linux_amd64.zip",
			"mv terraform ~/.local/bin/",
			"echo 'source session-tool.sh' >>~/.bash_profile",
			"rm -f get-pip.py terraform_0.11.8_linux_amd64.zip",
                        "source ~/.bash_profile"
		]
	}],

	"post-processors": [
		[{
			"type": "docker-tag",
			"repository": "{{user `currentuser`}}",
			"tag": "aws-dev"
		}]
	]

}
